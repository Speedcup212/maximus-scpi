import{r as b,j as o}from"./index-CRFhanc3.js";const F=({data:r,width:h=280,height:m=280,showLabels:N=!1,animated:R=!0})=>{const j=b.useRef(null),[g,P]=b.useState(null),[w,T]=b.useState({x:0,y:0}),[A,S]=b.useState(0);b.useEffect(()=>{if(S(0),R){const l=Date.now(),e=1e3,i=()=>{const u=Date.now()-l,t=Math.min(u/e,1),n=1-Math.pow(1-t,3);S(n),t<1&&requestAnimationFrame(i)};i()}else S(1)},[r,R]),b.useEffect(()=>{if(r.length===0)return;const l=j.current;if(!l)return;const e=l.getContext("2d");if(!e)return;const i=window.devicePixelRatio||1;l.width=h*i,l.height=m*i,l.style.width=`${h}px`,l.style.height=`${m}px`,e.scale(i,i),e.clearRect(0,0,h,m);const u=r.filter(s=>s.value>0);if(u.length===0)return;const t=h/2,n=m/2,x=Math.min(t,n)-20,v=x*.4,I=x+8;let d=-Math.PI/2;const M=u.reduce((s,f)=>s+f.value,0);if(u.forEach((s,f)=>{const a=s.value/M*2*Math.PI*A,c=g===f,p=c?I:x,k=e.createRadialGradient(t,n,v,t,n,p);if(k.addColorStop(0,s.color+"40"),k.addColorStop(1,s.color),e.beginPath(),e.arc(t,n,p,d,d+a),e.arc(t,n,v,d+a,d,!0),e.closePath(),e.fillStyle=k,e.fill(),e.strokeStyle=c?"#ffffff":"rgba(255, 255, 255, 0.3)",e.lineWidth=c?3:1,e.stroke(),c?(e.shadowColor="rgba(0, 0, 0, 0.3)",e.shadowBlur=10,e.shadowOffsetX=2,e.shadowOffsetY=2):e.shadowColor="transparent",N&&a>.2){const C=d+a/2,E=(x+v)/2,B=t+Math.cos(C)*E,$=n+Math.sin(C)*E;e.fillStyle="#ffffff",e.font="bold 12px Inter, sans-serif",e.textAlign="center",e.textBaseline="middle",e.fillText(`${(s.value/M*100).toFixed(0)}%`,B,$)}d+=a}),r.length>0){const s=document.documentElement.classList.contains("dark");if(e.beginPath(),e.arc(t,n,v-5,0,2*Math.PI),e.fillStyle=s?"rgba(17, 24, 39, 0.85)":"rgba(255, 255, 255, 0.95)",e.fill(),e.strokeStyle=s?"rgba(55, 65, 81, 0.5)":"rgba(229, 231, 235, 0.8)",e.lineWidth=1,e.stroke(),e.textAlign="center",e.textBaseline="middle",g!==null){const f=r[g],a=(f.value/M*100).toFixed(1);e.fillStyle=s?"#f9fafb":"#111827",e.font="bold 14px Inter, sans-serif",e.fillText(f.name,t,n-12),e.font="bold 24px Inter, sans-serif",e.fillStyle=f.color,e.fillText(`${a}%`,t,n+12)}else e.fillStyle=s?"#f9fafb":"#111827",e.font="bold 28px Inter, sans-serif",e.fillText(`${r.length}`,t,n-6),e.font="bold 13px Inter, sans-serif",e.fillStyle=s?"#d1d5db":"#6b7280",e.fillText("éléments",t,n+14)}},[r,h,m,g,A,N]);const X=l=>{const e=j.current;if(!e||r.length===0)return;const i=e.getBoundingClientRect(),u=l.clientX-i.left,t=l.clientY-i.top;T({x:l.clientX,y:l.clientY});const n=h/2,x=m/2,v=Math.min(n,x)-20,I=v*.4,d=Math.sqrt((u-n)**2+(t-x)**2);if(d>=I&&d<=v+8){const s=(Math.atan2(t-x,u-n)+Math.PI/2+2*Math.PI)%(2*Math.PI),f=r.reduce((c,p)=>c+p.value,0);let a=0;for(let c=0;c<r.length;c++){const p=r[c].value/f*2*Math.PI;if(s>=a&&s<=a+p){P(c);return}a+=p}}P(null)},Y=()=>{P(null)};if(r.length===0)return o.jsx("div",{className:"flex items-center justify-center h-64 text-gray-500 dark:text-gray-400",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:o.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v4a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),o.jsx("div",{className:"font-medium",children:"Aucune donnée"}),o.jsx("div",{className:"text-sm",children:"Sélectionnez vos SCPI pour voir la répartition"})]})});const y=g!==null?r[g]:null,z=r.reduce((l,e)=>l+e.value,0);return o.jsxs("div",{className:"relative",children:[o.jsx("canvas",{ref:j,width:h,height:m,onMouseMove:X,onMouseLeave:Y,className:"cursor-pointer transition-all duration-200",style:{filter:g!==null?"drop-shadow(0 4px 12px rgba(0,0,0,0.15))":"none"}}),y&&o.jsxs("div",{className:"fixed z-50 px-3 py-2 bg-gray-900 dark:bg-gray-800 text-white text-sm rounded-lg shadow-xl border border-gray-700 pointer-events-none transform -translate-x-1/2 -translate-y-full",style:{left:w.x,top:w.y-10},children:[o.jsx("div",{className:"font-semibold",children:y.name}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:y.color}}),o.jsxs("span",{children:[(y.value/z*100).toFixed(1),"%"]}),o.jsxs("span",{className:"text-gray-300",children:["(",y.value,")"]})]})]})]})};export{F as P};

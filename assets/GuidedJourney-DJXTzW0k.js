import{r as v,j as e}from"./index-CRFhanc3.js";import{s as I}from"./scpiData-D5apm83g.js";import{t as Y,k as Q,C as U,I as K,P as H,E as _,a as W,D as X}from"./App-CTFBvRA4.js";import{A as T}from"./arrow-left-Dq3Vputt.js";import{P as D}from"./pie-chart-DGhMTMoo.js";import{R as q,T as L,C as Z,X as ee,Y as se}from"./CartesianChart-B2qU--T2.js";import{P as E,a as M}from"./PieChart-Bsp7G2YJ.js";import{C as $,B as te,a as F}from"./BarChart-BnML-akf.js";import{C as re}from"./calendar-K9MhvfDo.js";import{L as ae}from"./Legend-C64z-WHA.js";function ne(r){switch(r){case"moins-2000":return"yield";case"2000-6000":return"balance";case"plus-6000":return"tax-optimization";case"je-ne-sais-pas":return"neutral";default:return"neutral"}}function le(r){const c=r.reduce((m,o)=>m+o.yield,0)/r.length;return r.filter(m=>{const o=m.capitalization>=5e7,n=m.tof>=90,u=m.debt===void 0||m.debt<30,b=m.discount<=0,p=m.yield>=c;return o&&n&&u&&b&&p&&!0})}function ie(r){const{taxSituation:c,objective:m,horizon:o,immediateIncome:n}=r;return n==="oui"||m==="revenus-reguliers"?"revenus-stables":m==="revenus-et-croissance"?"revenus-croissance":m==="croissance-long-terme"?"croissance-long-terme":o==="moins-8-ans"?"revenus-stables":o==="plus-15-ans"?"croissance-long-terme":m==="etre-guide"?"revenus-stables":"revenus-croissance"}function oe(r,c,m){const o={"revenus-stables":{id:"revenus-stables",name:"Portefeuille Revenus Stables",description:"Un portefeuille axé sur la génération de revenus réguliers avec une stabilité du capital.",riskLevel:"faible"},"revenus-croissance":{id:"revenus-croissance",name:"Portefeuille Revenus & Croissance",description:"Un équilibre entre revenus réguliers et croissance du capital sur le moyen terme.",riskLevel:"modere"},"croissance-long-terme":{id:"croissance-long-terme",name:"Portefeuille Croissance Long Terme",description:"Un portefeuille orienté vers la croissance du capital sur le long terme.",riskLevel:"modere"},"opportunites-immobilieres":{id:"opportunites-immobilieres",name:"Portefeuille Opportunités Immobilières",description:"Un portefeuille diversifié pour saisir les opportunités du marché immobilier.",riskLevel:"dynamique"},"immobilier-europeen":{id:"immobilier-europeen",name:"Portefeuille Immobilier Européen",description:"Un portefeuille diversifié géographiquement sur l'Europe pour réduire les risques.",riskLevel:"modere"}};let n=[];switch(r){case"revenus-stables":if(m==="yield")n=[...c].filter(s=>s.geography==="france").sort((s,d)=>d.yield-s.yield).slice(0,6);else if(m==="tax-optimization")n=[...c].filter(s=>s.geography==="europe"||s.european).sort((s,d)=>d.yield-s.yield).slice(0,6);else{const s=c.filter(t=>t.geography==="france").sort((t,i)=>i.yield-t.yield).slice(0,4),d=c.filter(t=>t.geography==="europe"||t.european).sort((t,i)=>i.yield-t.yield).slice(0,2);n=[...s,...d].slice(0,6)}break;case"revenus-croissance":if(m==="yield")n=[...c].filter(s=>s.geography==="france").sort((s,d)=>d.yield-s.yield).slice(0,6);else if(m==="tax-optimization")n=[...c].filter(s=>s.geography==="europe"||s.european).sort((s,d)=>d.yield*.6+d.capitalization/1e6*.4-(s.yield*.6+s.capitalization/1e6*.4)).slice(0,6);else{const s=c.filter(t=>t.geography==="france").sort((t,i)=>i.yield-t.yield).slice(0,3),d=c.filter(t=>t.geography==="europe").sort((t,i)=>i.capitalization-t.capitalization).slice(0,3);n=[...s,...d].slice(0,6)}break;case"croissance-long-terme":m==="tax-optimization"?n=[...c].filter(s=>s.geography==="europe"||s.european).sort((s,d)=>d.capitalization-s.capitalization).slice(0,6):n=[...c].sort((s,d)=>d.capitalization-s.capitalization).slice(0,6);break;case"opportunites-immobilieres":if(m==="tax-optimization"){if(n=["bureaux","commerces","sante","logistique","diversifie"].map(d=>c.find(t=>t.sector===d&&(t.geography==="europe"||t.european))).filter(d=>d!==void 0).slice(0,6),n.length<6){const d=c.filter(t=>!n.find(i=>i.id===t.id)).slice(0,6-n.length);n=[...n,...d].slice(0,6)}}else n=["bureaux","commerces","sante","logistique","diversifie"].map(d=>c.find(t=>t.sector===d)).filter(d=>d!==void 0).slice(0,6);break;case"immobilier-europeen":n=c.filter(s=>s.geography==="europe"||s.european).slice(0,6);break}n.length<5&&(n=[...c].slice(0,5)),n=n.slice(0,6);const u=n.length,b=100/u;let p;if(b<=25)p=n.map(s=>({scpiId:s.id,allocation:b}));else{const t=100-25*u;p=n.map((i,h)=>({scpiId:i.id,allocation:25+t/u}))}const f=p.reduce((s,d)=>s+d.allocation,0);if(Math.abs(f-100)>.01){const s=100-f;p[0].allocation+=s}return p=p.map(s=>({...s,allocation:Math.round(s.allocation*10)/10})),{...o[r],scpis:p,logic:"SCPI sélectionnées pour leur solidité, leur taux d'occupation élevé, leur faible endettement et leur décote à l'achat."}}function ce(r,c){const m=le(c),o=ie(r),n=ne(r.taxSituation),u=oe(o,m,n),b=de(u,r);return{portfolio:u,explanation:b}}function de(r,c){const{objective:m,horizon:o}=c;let n=`Nous vous recommandons le ${r.name} car il correspond à votre situation. `;return m==="revenus-reguliers"||c.immediateIncome==="oui"?n+="Ce portefeuille est conçu pour générer des revenus réguliers tout en préservant votre capital. ":m==="croissance-long-terme"||o==="plus-15-ans"?n+="Ce portefeuille est orienté vers la croissance de votre capital sur le long terme. ":n+="Ce portefeuille équilibre revenus réguliers et croissance du capital. ",n+=r.logic,n}const me=({onComplete:r,onClose:c})=>{const[m,o]=v.useState(1),[n,u]=v.useState({}),b=[{id:1,question:"Combien d'impôt sur le revenu payez-vous chaque année ?",key:"taxSituation",options:[{value:"moins-2000",label:"Moins de 2 000 € par an",subtitle:"(peu ou pas fiscalisé)"},{value:"2000-6000",label:"Entre 2 000 € et 6 000 € par an",subtitle:"(fiscalité intermédiaire)"},{value:"plus-6000",label:"Plus de 6 000 € par an",subtitle:"(fortement fiscalisé)"},{value:"je-ne-sais-pas",label:"Je ne sais pas / je préfère ne pas répondre"}]},{id:2,question:"Avec cet investissement immobilier, souhaitez-vous plutôt…",key:"objective",options:[{value:"revenus-reguliers",label:"Avoir des revenus réguliers"},{value:"revenus-et-croissance",label:"Avoir des revenus et faire progresser mon capital"},{value:"croissance-long-terme",label:"Faire progresser mon capital sur le long terme"},{value:"etre-guide",label:"Être guidé, je débute"}]},{id:3,question:"Sur combien de temps envisagez-vous cet investissement ?",key:"horizon",options:[{value:"moins-8-ans",label:"Moins de 8 ans"},{value:"8-15-ans",label:"Entre 8 et 15 ans"},{value:"plus-15-ans",label:"Plus de 15 ans"},{value:"je-ne-sais-pas",label:"Je ne sais pas"}]},{id:4,question:"Avez-vous besoin de revenus rapidement ?",key:"immediateIncome",options:[{value:"oui",label:"Oui"},{value:"non",label:"Non"},{value:"je-ne-sais-pas",label:"Je ne sais pas"}]},{id:5,question:"Combien souhaitez-vous investir ?",key:"investmentAmount",type:"number"}],p=b[m-1],f=m===b.length,j=t=>{const i={...n,[p.key]:t};u(i),p.id!==5&&setTimeout(()=>{if(f){const h={...i,[p.key]:t};Object.keys(h).length===b.length&&r(h)}else o(h=>h+1)},300)},s=()=>{m>1?o(t=>t-1):c&&c()},d=m/b.length*100;return e.jsx("div",{className:"min-h-screen bg-slate-900 text-slate-100 py-12 px-4",children:e.jsxs("div",{className:"max-w-2xl mx-auto bg-slate-900/60 border border-slate-700 rounded-2xl shadow-xl p-6 sm:p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-white mb-4",children:"Votre parcours d'investissement guidé"}),e.jsx("p",{className:"text-lg text-slate-300",children:"Répondez à 5 questions simples pour recevoir une recommandation personnalisée"})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex justify-between text-sm text-slate-300 mb-2",children:[e.jsxs("span",{children:["Question ",m," sur ",b.length]}),e.jsxs("span",{children:[Math.round(d),"%"]})]}),e.jsx("div",{className:"w-full bg-slate-800 rounded-full h-2",children:e.jsx("div",{className:"bg-emerald-500 h-2 rounded-full transition-all duration-300",style:{width:`${d}%`}})})]}),e.jsxs("div",{className:"bg-slate-900/80 border border-slate-700 rounded-2xl shadow-xl p-8 mb-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:p.question}),e.jsxs("p",{className:"text-sm text-slate-400 flex items-center gap-2",children:[e.jsx(Y,{className:"w-4 h-4"}),'Toutes les réponses sont acceptées, y compris "Je ne sais pas"']})]}),p.type==="number"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:n.investmentAmount||"",onChange:t=>{const i=t.target.value;j(i===""||i==="0"?0:Number(i))},min:1e3,step:1e3,placeholder:"Entrez un montant",className:"w-full px-4 py-4 bg-slate-800 border-2 border-slate-600 text-white rounded-xl text-2xl font-bold focus:outline-none focus:border-emerald-500 transition-colors"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 font-semibold text-xl",children:"€"})]}),e.jsx("p",{className:"text-xs text-slate-400",children:"Minimum: 1 000 €"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-300 mb-3",children:"Montants rapides :"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[1e4,25e3,5e4,1e5,2e5,5e5].map(t=>{const i=n.investmentAmount===t;return e.jsx("button",{onClick:()=>j(t),className:`px-4 py-3 border-2 rounded-xl text-sm font-semibold transition-all ${i?"bg-emerald-600 border-emerald-500 text-white":"bg-slate-800 hover:bg-slate-700 border-slate-600 hover:border-emerald-500 text-slate-200"}`,children:t>=1e3?`${t/1e3}k€`:`${t}€`},t)})})]}),n.investmentAmount&&typeof n.investmentAmount=="number"&&n.investmentAmount>=1e3&&e.jsx("button",{onClick:()=>{const t={...n,investmentAmount:n.investmentAmount};r(t)},className:"w-full mt-4 px-6 py-4 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-xl transition-colors",children:"Voir ma recommandation"})]}):e.jsx("div",{className:"space-y-3",children:p.options?.map(t=>{const i=n[p.key]===t.value;return e.jsx("button",{onClick:()=>j(t.value),className:`w-full text-left p-4 rounded-xl border-2 transition-all ${i?"border-emerald-500 bg-emerald-500/10 text-emerald-300":"border-slate-700 hover:border-slate-500 hover:bg-slate-800"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium text-slate-100",children:t.label}),t.subtitle&&e.jsx("span",{className:"text-xs text-slate-400 mt-1",children:t.subtitle})]}),i&&e.jsx("div",{className:"w-5 h-5 bg-emerald-500 rounded-full flex items-center justify-center",children:e.jsx("div",{className:"w-2 h-2 bg-slate-900 rounded-full"})})]})},t.value)})})]}),e.jsx("div",{className:"flex justify-start",children:e.jsxs("button",{onClick:s,className:"flex items-center gap-2 px-6 py-3 bg-slate-800 border border-slate-600 rounded-xl font-semibold text-slate-100 hover:bg-slate-700 transition-colors",children:[e.jsx(T,{className:"w-5 h-5"}),m===1?"Annuler":"Précédent"]})}),e.jsx("div",{className:"mt-8 bg-slate-900/80 border border-slate-700 rounded-xl p-4",children:e.jsxs("p",{className:"text-sm text-slate-200",children:[e.jsx("strong",{children:"Conseil professionnel :"})," Ce questionnaire vous guide vers un portefeuille adapté à votre situation. Aucune promesse de performance. Investissement avec risque de perte en capital."]})})]})})};function ue(r){if(r.length===0)return{averageYield:0,scpiCount:0,sectors:[],sectorCount:0,geographies:[],geographyCount:0,averageTof:0,averageDebt:null,averageDiscount:0,isrCount:0,noFeesCount:0,sectorDistribution:{},geoDistribution:{}};const c=r.reduce((t,i)=>t+i.scpi.yield*i.allocation/100,0),m=r.reduce((t,i)=>t+i.scpi.tof*i.allocation/100,0),o=r.map(t=>t.scpi.debt!==void 0?t.scpi.debt*t.allocation/100:null).filter(t=>t!==null),n=o.length>0?o.reduce((t,i)=>t+i,0):null,u=r.reduce((t,i)=>t+i.scpi.discount*i.allocation/100,0),b=[...new Set(r.map(t=>t.scpi.sector).filter(Boolean))],p=[...new Set(r.map(t=>t.scpi.geography).filter(Boolean))],f=r.filter(t=>t.scpi.isr).length,j=r.filter(t=>t.scpi.fees===0).length,s={};r.forEach(({scpi:t,allocation:i})=>{if(t.repartitionSector&&t.repartitionSector.length>0)t.repartitionSector.forEach(h=>{s[h.name]||(s[h.name]=0),s[h.name]+=h.value*i/100});else if(t.sector){const h=xe(t.sector);s[h]||(s[h]=0),s[h]+=i}});const d={};return r.forEach(({scpi:t,allocation:i})=>{if(t.repartitionGeo&&t.repartitionGeo.length>0)t.repartitionGeo.forEach(h=>{d[h.name]||(d[h.name]=0),d[h.name]+=h.value*i/100});else if(t.geography){const h=pe(t.geography);d[h]||(d[h]=0),d[h]+=i}}),{averageYield:c,scpiCount:r.length,sectors:b,sectorCount:b.length,geographies:p,geographyCount:p.length,averageTof:m,averageDebt:n,averageDiscount:u,isrCount:f,noFeesCount:j,sectorDistribution:s,geoDistribution:d}}function xe(r){return{bureaux:"Bureaux",commerces:"Commerces",residentiel:"Résidentiel",sante:"Santé",logistique:"Logistique",hotellerie:"Hôtellerie",diversifie:"Diversifié"}[r]||"Autres"}function pe(r){return{france:"France",europe:"Europe",international:"International"}[r]||"Autres"}function he(r){return r<=15e3?2:r<=3e4?3:r<=6e4?4:r<=1e5?5:6}function ge(r,c,m){let o=0;switch(o+=m*10,c){case"revenus-stables":o+=r.yield*2,o+=r.tof*.5,r.geography==="france"&&(o+=20),r.capitalization>=1e8&&(o+=10);break;case"revenus-croissance":o+=r.yield*1.5,o+=r.capitalization/1e6*.1,(r.geography==="france"||r.geography==="europe")&&(o+=15);break;case"croissance-long-terme":o+=r.capitalization/1e6*.2,(r.geography==="europe"||r.european)&&(o+=20),r.capitalization>=2e8&&(o+=15);break;case"opportunites-immobilieres":o+=Math.abs(r.discount)*2,r.capitalization>=1e8&&(o+=10);break;case"immobilier-europeen":(r.geography==="europe"||r.european)&&(o+=30),o+=r.yield*1.5;break}return r.tof>=95&&(o+=10),r.capitalization>=1e8&&(o+=5),r.isr&&(o+=5),r.fees===0&&(o+=3),o}function fe(r,c,m){const o=he(m);if(r.length<=o)return{adaptedScpis:r,maxScpiCount:o};const n=r.map(s=>({...s,priorityScore:ge(s.scpi,c,s.allocation)}));n.sort((s,d)=>d.priorityScore-s.priorityScore);const u=n.slice(0,o),p=100/u.reduce((s,d)=>s+d.allocation,0),f=u.map(s=>({scpi:s.scpi,allocation:Math.round(s.allocation*p*10)/10})),j=f.reduce((s,d)=>s+d.allocation,0);if(Math.abs(j-100)>.01){const s=100-j;f[0].allocation=Math.round((f[0].allocation+s)*10)/10}return{adaptedScpis:f,maxScpiCount:o}}const R=({title:r,subtitle:c,isExpanded:m,onToggle:o,children:n})=>e.jsxs("div",{className:"bg-slate-900/80 border border-slate-700 rounded-xl overflow-hidden mb-4",children:[e.jsxs("button",{onClick:o,className:"w-full px-6 py-4 flex items-center justify-between hover:bg-slate-800/50 transition-colors text-left",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:r}),c&&e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:c})]}),e.jsx(Q,{className:`w-5 h-5 text-slate-400 transition-transform duration-200 flex-shrink-0 ml-4 ${m?"rotate-180":""}`})]}),m&&e.jsx("div",{className:"px-6 py-4 border-t border-slate-700 animate-in slide-in-from-top-2 duration-200",children:n})]}),A={sectors:["gradBlue","gradTeal","gradOrange","gradPink","gradPurple","gradCyan","gradLime","gradRed"],geography:["gradBlue2","gradTeal2","gradOrange2","gradPink2","gradPurple2","gradCyan2","gradLime2","gradRed2"]},S={sectors:["#2563eb","#059669","#d97706","#db2777","#7c3aed","#0891b2","#65a30d","#ea580c"],geography:["#2563eb","#059669","#d97706","#db2777","#7c3aed","#0891b2","#65a30d","#ea580c"]},O=({active:r,payload:c})=>r&&c&&c.length?e.jsxs("div",{className:"bg-slate-800 px-4 py-2 rounded-lg border border-slate-600 shadow-xl",children:[e.jsx("p",{className:"text-white font-semibold text-sm",children:c[0].name}),e.jsxs("p",{className:"text-emerald-400 font-bold text-lg",children:[c[0].value.toFixed(1),"%"]})]}):null,be=({portfolioScpis:r,analysis:c,initialInvestmentAmount:m})=>{const[o,n]=v.useState(m||5e4),[u,b]=v.useState(15),p=v.useMemo(()=>r.reduce((a,x)=>{const y=o*x.allocation/100,C=Math.floor(y/x.scpi.price);return a+C},0),[o,r]),f=v.useMemo(()=>r.reduce((a,x)=>{const y=o*x.allocation/100,C=Math.floor(y/x.scpi.price);return a+C*x.scpi.price},0),[o,r]),j=v.useMemo(()=>p===0?0:f/p,[f,p]),s=f*c.averageYield/100,d=Array.from({length:u+1},(a,x)=>{const y=s*x,C=f+y;return{year:x===0?"Début":`An ${x}`,capital:f,revenus:y,total:C}}),t=Object.entries(c.sectorDistribution).map(([a,x],y)=>({name:a,value:Math.round(x*10)/10,color:S.sectors[y%S.sectors.length]})).sort((a,x)=>x.value-a.value).filter(a=>a.value>0),i=Object.entries(c.geoDistribution).map(([a,x],y)=>({name:a,value:Math.round(x*10)/10,color:S.geography[y%S.geography.length]})).sort((a,x)=>x.value-a.value).filter(a=>a.value>0),h=Math.min(...r.map(a=>a.scpi.price)),w=Math.max(...r.map(a=>a.scpi.minInvestment||a.scpi.price));return e.jsxs("div",{className:"bg-slate-900/80 border border-slate-700 rounded-xl sm:rounded-2xl shadow-xl p-4 sm:p-6 lg:p-8 mb-4 sm:mb-6",children:[e.jsxs("h2",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-white mb-2 sm:mb-3 flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5 sm:w-6 sm:h-6 text-emerald-400 flex-shrink-0"}),e.jsx("span",{className:"break-words",children:"Analyse détaillée du portefeuille (pour mieux comprendre)"})]}),e.jsx("p",{className:"text-slate-300 mb-4 sm:mb-6 text-xs sm:text-sm",children:"Les éléments ci-dessous vous permettent de mieux comprendre la construction de votre portefeuille recommandé."}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-emerald-500/10 to-emerald-600/5 rounded-lg sm:rounded-xl border border-emerald-500/20 p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-bold text-white mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(X,{className:"w-4 h-4 sm:w-5 sm:h-5 text-emerald-400 flex-shrink-0"}),"Montant à Investir"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs sm:text-sm font-medium text-slate-300 mb-2 block",children:"Montant d'investissement"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:o,onChange:a=>{const x=a.target.value;n(x===""||x==="0"?0:Number(x))},min:0,step:h,placeholder:"Entrez un montant",className:"w-full px-3 sm:px-4 py-2 sm:py-3 bg-slate-700 border-2 border-slate-600 text-white rounded-lg text-lg sm:text-xl font-bold focus:outline-none focus:border-emerald-500 transition-colors"}),e.jsx("span",{className:"absolute right-3 sm:right-4 top-1/2 -translate-y-1/2 text-slate-400 font-semibold text-base sm:text-lg",children:"€"})]}),e.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:["Minimum: ",w.toLocaleString("fr-FR"),"€"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-2",children:"Montants rapides:"}),e.jsx("div",{className:"grid grid-cols-3 gap-1.5 sm:gap-2",children:[1e4,25e3,5e4,1e5,2e5,5e5].map(a=>e.jsx("button",{onClick:()=>n(a),className:`px-2 sm:px-3 py-1.5 sm:py-2 border rounded-lg text-xs sm:text-sm font-semibold transition-all ${o===a?"bg-emerald-600 border-emerald-500 text-white":"bg-slate-700 hover:bg-emerald-600 border-slate-600 hover:border-emerald-500 text-white"}`,children:a>=1e3?`${a/1e3}k€`:`${a}€`},a))})]})]}),e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsx("div",{className:"bg-slate-700/50 rounded-lg p-3 sm:p-4 border border-slate-600",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm text-slate-400",children:"Nombre de parts"}),e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-white",children:p})]})}),e.jsx("div",{className:"bg-emerald-500/10 rounded-lg p-3 sm:p-4 border border-emerald-500/30",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm text-slate-300 font-medium",children:"Investissement réel"}),e.jsxs("span",{className:"text-xl sm:text-2xl font-bold text-emerald-400 break-words",children:[f.toLocaleString("fr-FR"),"€"]})]})}),e.jsx("div",{className:"bg-slate-700/50 rounded-lg p-3 sm:p-4 border border-slate-600",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm text-slate-400",children:"Prix moyen par part"}),e.jsxs("span",{className:"text-base sm:text-lg font-bold text-white",children:[j.toFixed(0),"€"]})]})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"bg-slate-700/30 rounded-lg sm:rounded-xl border border-slate-700 p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-bold text-white mb-2 flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-400 flex-shrink-0"}),"Répartition Sectorielle"]}),e.jsx("p",{className:"text-xs sm:text-sm text-slate-300 mb-3 sm:mb-4",children:"Cette répartition sectorielle permet de limiter la dépendance à un seul cycle immobilier. En diversifiant les secteurs, vous réduisez l'impact d'une baisse temporaire dans un domaine spécifique."}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{width:"100%",height:220,children:e.jsxs(E,{children:[e.jsx("defs",{children:A.sectors.map((a,x)=>e.jsxs("linearGradient",{id:a,x1:"0",y1:"0",x2:"1",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:S.sectors[x],stopOpacity:1}),e.jsx("stop",{offset:"100%",stopColor:S.sectors[x],stopOpacity:.7})]},a))}),e.jsx(M,{data:t,cx:"50%",cy:"50%",innerRadius:"50%",outerRadius:"90%",paddingAngle:0,dataKey:"value",animationBegin:0,animationDuration:800,animationEasing:"ease-out",children:t.map((a,x)=>e.jsx($,{fill:`url(#${A.sectors[x%A.sectors.length]})`,stroke:"#1e293b",strokeWidth:2,style:{outline:"none"}},`cell-${x}`))}),e.jsx(L,{content:e.jsx(O,{})})]})}),e.jsxs("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center pointer-events-none",children:[e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-white",children:t.length}),e.jsx("div",{className:"text-xs sm:text-sm text-slate-400",children:"secteurs"})]})]}),e.jsx("div",{className:"mt-3 sm:mt-4 space-y-1.5 sm:space-y-2",children:t.map((a,x)=>e.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("div",{className:"w-2.5 h-2.5 sm:w-3 sm:h-3 rounded-full flex-shrink-0",style:{backgroundColor:a.color}}),e.jsx("span",{className:"text-slate-300 truncate",children:a.name})]}),e.jsxs("span",{className:"font-semibold text-white ml-2 flex-shrink-0",children:[a.value.toFixed(1),"%"]})]},a.name))})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded-lg sm:rounded-xl border border-slate-700 p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-bold text-white mb-2 flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-400 flex-shrink-0"}),"Répartition Géographique"]}),e.jsx("p",{className:"text-xs sm:text-sm text-slate-300 mb-3 sm:mb-4",children:"Cette répartition géographique réduit votre exposition aux risques locaux. En investissant dans plusieurs zones, vous bénéficiez de la stabilité de marchés complémentaires."}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{width:"100%",height:220,children:e.jsxs(E,{children:[e.jsx("defs",{children:A.geography.map((a,x)=>e.jsxs("linearGradient",{id:a,x1:"0",y1:"0",x2:"1",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:S.geography[x],stopOpacity:1}),e.jsx("stop",{offset:"100%",stopColor:S.geography[x],stopOpacity:.7})]},a))}),e.jsx(M,{data:i,cx:"50%",cy:"50%",innerRadius:"50%",outerRadius:"90%",paddingAngle:0,dataKey:"value",animationBegin:0,animationDuration:800,animationEasing:"ease-out",children:i.map((a,x)=>e.jsx($,{fill:`url(#${A.geography[x%A.geography.length]})`,stroke:"#1e293b",strokeWidth:2,style:{outline:"none"}},`cell-${x}`))}),e.jsx(L,{content:e.jsx(O,{})})]})}),e.jsxs("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center pointer-events-none",children:[e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-white",children:i.length}),e.jsx("div",{className:"text-xs sm:text-sm text-slate-400",children:"pays"})]})]}),e.jsx("div",{className:"mt-3 sm:mt-4 space-y-1.5 sm:space-y-2",children:i.map((a,x)=>e.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("div",{className:"w-2.5 h-2.5 sm:w-3 sm:h-3 rounded-full flex-shrink-0",style:{backgroundColor:a.color}}),e.jsx("span",{className:"text-slate-300 truncate",children:a.name})]}),e.jsxs("span",{className:"font-semibold text-white ml-2 flex-shrink-0",children:[a.value.toFixed(1),"%"]})]},a.name))})]})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded-lg sm:rounded-xl border border-slate-700 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-2",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-bold text-white flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4 sm:w-5 sm:h-5 text-orange-400 flex-shrink-0"}),"Projection sur ",u," ans"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-xs sm:text-sm text-slate-400",children:"Durée:"}),e.jsxs("select",{value:u,onChange:a=>b(Number(a.target.value)),className:"px-2 sm:px-3 py-1 sm:py-1.5 bg-slate-700 border border-slate-600 text-white rounded-lg text-xs sm:text-sm focus:outline-none focus:border-emerald-500",children:[e.jsx("option",{value:5,children:"5 ans"}),e.jsx("option",{value:10,children:"10 ans"}),e.jsx("option",{value:15,children:"15 ans"}),e.jsx("option",{value:20,children:"20 ans"})]})]})]}),e.jsxs("div",{className:"mb-3 sm:mb-4 space-y-2",children:[e.jsxs("p",{className:"text-xs sm:text-sm text-slate-300 leading-relaxed mb-2 sm:mb-3",children:["Cette projection illustre l'évolution potentielle de votre investissement sur ",u," ans, en supposant un rendement constant. Elle vous aide à visualiser l'accumulation progressive des revenus et l'évolution de votre patrimoine, sans garantie de résultat."]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-2 sm:p-3",children:e.jsxs("p",{className:"text-xs text-yellow-200 leading-relaxed",children:[e.jsx("strong",{children:"Projection indicative basée sur des hypothèses."})," Les performances passées ne préjugent pas des performances futures. Les revenus peuvent varier et le capital n'est pas garanti."]})})]}),e.jsx(q,{width:"100%",height:250,children:e.jsxs(te,{data:[...d],children:[e.jsx(Z,{strokeDasharray:"3 3",stroke:"#475569"}),e.jsx(ee,{dataKey:"year",stroke:"#94a3b8"}),e.jsx(se,{stroke:"#94a3b8",tickFormatter:a=>`${(a/1e3).toFixed(0)}k€`}),e.jsx(L,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #475569",borderRadius:"8px"},labelStyle:{color:"#fff"},formatter:a=>`${a.toLocaleString("fr-FR")}€`}),e.jsx(ae,{}),e.jsx(F,{dataKey:"capital",name:"Capital investi",stackId:"a",fill:"#3b82f6"}),e.jsx(F,{dataKey:"revenus",name:"Revenus cumulés",stackId:"a",fill:"#10b981"})]})}),e.jsx("div",{className:"mt-3 sm:mt-4 bg-slate-800/50 rounded-lg p-3 sm:p-4 border border-slate-600",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-0",children:[e.jsxs("span",{className:"text-xs sm:text-sm text-slate-300",children:["Patrimoine total après ",u," ans"]}),e.jsxs("span",{className:"text-xl sm:text-2xl font-bold text-emerald-400 break-words",children:[(f+s*u).toLocaleString("fr-FR"),"€"]})]})})]})]})]})},ve=({recommendation:r,answers:c,onBack:m,onStartSubscription:o,onCalendlyClick:n})=>{const{portfolio:u,explanation:b}=r,[p,f]=v.useState(c.investmentAmount||5e4),j=v.useMemo(()=>!I||I.length===0?[]:u.scpis.map(g=>{const N=I.find(P=>P.id===g.scpiId);return N?{scpi:N,allocation:g.allocation}:null}).filter(g=>g!==null),[u.scpis]),{adaptedScpis:s,maxScpiCount:d}=v.useMemo(()=>fe(j,u.id,p),[j,u.id,p]),t=v.useMemo(()=>ue(s),[s]),i=s.length<j.length;v.useMemo(()=>{const{taxSituation:l,objective:g,horizon:N,immediateIncome:P}=c;let k="Ce portefeuille a été construit en tenant compte de votre situation personnelle. ";return l==="plus-6000"?k+="Votre situation fiscale (plus de 6 000 € d'impôt annuel) a orienté la sélection vers des SCPI permettant une optimisation fiscale, notamment européennes. ":l==="moins-2000"?k+="Votre faible imposition (moins de 2 000 € d'impôt annuel) permet de privilégier la performance brute. ":l==="2000-6000"&&(k+="Votre situation fiscale intermédiaire (entre 2 000 € et 6 000 € d'impôt annuel) permet d'équilibrer rendement et diversification. "),g==="revenus-reguliers"||P==="oui"?k+="L'accent a été mis sur la génération de revenus réguliers et prévisibles. ":g==="croissance-long-terme"||N==="plus-15-ans"?k+="L'horizon long terme permet de privilégier la croissance du capital. ":g==="revenus-et-croissance"&&(k+="Un équilibre a été recherché entre revenus réguliers et croissance du capital. "),N==="moins-8-ans"?k+="Avec un horizon plus court, la stabilité et la liquidité relative ont été privilégiées. ":N==="plus-15-ans"&&(k+="L'horizon long terme permet de mieux absorber les fluctuations de marché. "),k+=`Le niveau de risque ${u.riskLevel==="faible"?"faible":u.riskLevel==="modere"?"modéré":"dynamique"} de ce portefeuille correspond à votre profil.`,k},[c,u.riskLevel]);const h={faible:"bg-green-100 text-green-800 border-green-300",modere:"bg-yellow-100 text-yellow-800 border-yellow-300",dynamique:"bg-orange-100 text-orange-800 border-orange-300"},w={faible:"Faible",modere:"Modéré",dynamique:"Dynamique"},a=v.useMemo(()=>{const{riskLevel:l}=u,g=u.id;return l==="faible"?3:l==="modere"?g==="immobilier-europeen"?4:3:l==="dynamique"?4:3},[u.riskLevel,u.id]),[x,y]=v.useState({why:!0,composition:!0,analysis:!0}),[C,z]=v.useState(!1),B=l=>{l&&(l.preventDefault(),l.stopPropagation()),n?n():window.open("https://calendly.com/eric-bellaiche/gp-rendez-vous-avec-eric-bellaiche-clone","_blank")},G=async l=>{if(l&&(l.preventDefault(),l.stopPropagation()),!C)try{if(z(!0),!s||s.length===0){alert("Erreur : Aucune SCPI sélectionnée. Veuillez réessayer."),z(!1);return}const g=s.map(N=>N.scpi.id);o?await o(g):alert("Erreur : Impossible d'ouvrir le tunnel. Veuillez réessayer."),z(!1)}catch(g){console.error("Erreur lors de l'ouverture du tunnel:",g),alert("Une erreur est survenue. Veuillez réessayer."),z(!1)}},J=v.useMemo(()=>{const{objective:l,immediateIncome:g,horizon:N}=c;return l==="revenus-reguliers"||g==="oui"?"Pour générer des revenus réguliers tout en privilégiant la stabilité du capital.":l==="croissance-long-terme"||N==="plus-15-ans"?"Pour faire progresser votre capital sur le long terme avec une approche équilibrée.":l==="revenus-et-croissance"?"Pour combiner revenus réguliers et croissance du capital sur le moyen terme.":"Pour vous accompagner dans votre projet d'investissement avec une solution adaptée à votre profil."},[c]),V=v.useMemo(()=>{const l=[],{objective:g,immediateIncome:N,horizon:P}=c;return g==="revenus-reguliers"||N==="oui"?(l.push("Générer des revenus réguliers et prévisibles"),l.push("Préserver votre capital investi")):g==="croissance-long-terme"||P==="plus-15-ans"?(l.push("Faire progresser votre capital sur le long terme"),l.push("Bénéficier d'une diversification solide")):(l.push("Équilibrer revenus réguliers et croissance du capital"),l.push("Diversifier votre investissement immobilier")),l.push("Réduire les risques grâce à la diversification"),P==="moins-8-ans"?l.push("Adapter votre investissement à un horizon plus court"):P==="plus-15-ans"&&l.push("Optimiser votre investissement pour le long terme"),l.slice(0,4)},[c]);return e.jsx("div",{className:"min-h-screen bg-slate-900 text-slate-100 py-4 sm:py-12 px-2 sm:px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto bg-slate-900/60 border border-slate-700 rounded-xl sm:rounded-2xl shadow-xl p-3 sm:p-6 lg:p-8",children:[e.jsxs("button",{onClick:m,className:"flex items-center gap-2 text-slate-300 hover:text-white mb-4 sm:mb-6 transition-colors text-sm sm:text-base",children:[e.jsx(T,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"hidden sm:inline",children:"Retour au questionnaire"}),e.jsx("span",{className:"sm:hidden",children:"Retour"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-emerald-600/20 to-emerald-500/10 border border-emerald-500/30 rounded-xl sm:rounded-2xl p-4 sm:p-6 mb-4 sm:mb-6",children:[e.jsxs("div",{className:"text-center mb-4 sm:mb-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 sm:w-14 sm:h-14 bg-emerald-600 rounded-full mb-3 sm:mb-4",children:e.jsx(U,{className:"w-6 h-6 sm:w-7 sm:h-7 text-white"})}),e.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-white mb-2",children:"Votre portefeuille recommandé"}),e.jsx("p",{className:"text-sm sm:text-base text-slate-300",children:"Adapté à votre situation"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4 mb-4 sm:mb-6",children:[e.jsxs("div",{className:"bg-slate-900/60 rounded-lg sm:rounded-xl p-3 sm:p-4 border border-slate-700",children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Portefeuille"}),e.jsx("div",{className:"text-base sm:text-lg font-bold text-white break-words",children:u.name})]}),e.jsxs("div",{className:"bg-slate-900/60 rounded-lg sm:rounded-xl p-3 sm:p-4 border border-slate-700",children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Objectif"}),e.jsx("div",{className:"text-xs sm:text-sm text-slate-200 leading-tight",children:J})]}),e.jsxs("div",{className:"bg-slate-900/60 rounded-lg sm:rounded-xl p-3 sm:p-4 border border-slate-700",children:[e.jsx("div",{className:"text-xs text-slate-400 mb-2",children:"Risque"}),e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:`px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm font-bold border-2 ${h[u.riskLevel]}`,children:w[u.riskLevel]})}),e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 mb-1",children:[e.jsx("span",{className:"text-xs text-slate-400 hidden sm:inline",children:"Profil :"}),e.jsxs("div",{className:"flex-1 flex flex-col gap-0.5 sm:gap-1",children:[e.jsx("div",{className:"flex gap-0.5 sm:gap-1",children:[1,2,3,4,5,6,7].map(l=>{const g=l<=a,N=a===3?g?"bg-green-500":"bg-slate-700":a===4?g?"bg-orange-500":"bg-slate-700":g?"bg-red-500":"bg-slate-700";return e.jsx("div",{className:`flex-1 h-4 sm:h-5 rounded transition-all duration-500 ${N}`},l)})}),e.jsx("div",{className:"flex gap-0.5 sm:gap-1",children:[1,2,3,4,5,6,7].map(l=>e.jsx("div",{className:"flex-1 text-center",children:e.jsx("span",{className:"text-[10px] sm:text-xs text-slate-400",children:l})},l))})]}),e.jsxs("span",{className:"text-[10px] sm:text-xs font-bold text-slate-300 min-w-[2rem] text-right",children:[a,"/7"]})]})})]})]})]}),e.jsxs("div",{className:"bg-slate-900/80 border border-slate-700 rounded-xl sm:rounded-2xl shadow-xl p-4 sm:p-6 lg:p-8 mb-4 sm:mb-6",children:[e.jsxs(R,{title:"Pourquoi ce portefeuille vous correspond",isExpanded:x.why,onToggle:()=>y(l=>({...l,why:!l.why})),children:[e.jsx("p",{className:"text-slate-200 leading-relaxed mb-4",children:"Ce portefeuille a été construit en tenant compte de votre situation personnelle et de vos objectifs."}),e.jsx("ul",{className:"space-y-2",children:V.map((l,g)=>e.jsxs("li",{className:"flex items-start gap-3 text-slate-200",children:[e.jsx("span",{className:"text-emerald-400 mt-1",children:"•"}),e.jsx("span",{children:l})]},g))})]}),e.jsxs(R,{title:`Les ${s.length} SCPI recommandées`,subtitle:i?`Pour un montant de ${p.toLocaleString("fr-FR")} €, le portefeuille est concentré sur ${s.length} SCPI pour conserver une allocation lisible et efficace.`:`${s.length} SCPI sélectionnées pour leur solidité, leur taux d'occupation élevé, leur faible endettement et leur décote à l'achat.`,isExpanded:x.composition,onToggle:()=>y(l=>({...l,composition:!l.composition})),children:[e.jsx("div",{className:"space-y-2 sm:space-y-3",children:s.map(({scpi:l,allocation:g})=>e.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 bg-slate-900 rounded-lg border border-slate-700",children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-2",children:[e.jsx("div",{className:"font-semibold text-slate-100 text-sm sm:text-base truncate",children:l.name}),e.jsx("div",{className:"text-xs sm:text-sm text-slate-400 truncate",children:l.company})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsxs("div",{className:"text-xl sm:text-2xl font-bold text-emerald-400",children:[l.yield.toFixed(2),"%"]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Répartition: ",g.toFixed(1),"%"]})]})]},l.id))}),i&&e.jsx("p",{className:"text-sm text-slate-300 leading-relaxed mt-4",children:"Cette approche professionnelle privilégie la qualité et la simplicité. La diversification pourra être renforcée dans le temps lors de futurs investissements."})]})]}),e.jsx(R,{title:"Analyse détaillée",subtitle:"Pour approfondir votre compréhension du portefeuille",isExpanded:x.analysis,onToggle:()=>y(l=>({...l,analysis:!l.analysis})),children:e.jsx(be,{portfolioScpis:s,analysis:t,initialInvestmentAmount:p})}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"bg-emerald-500/10 border-l-4 border-emerald-500 rounded-lg p-3 sm:p-4",children:[e.jsx("h3",{className:"text-base sm:text-lg font-bold text-white mb-2",children:"Prochaine étape"}),e.jsx("p",{className:"text-slate-200 leading-relaxed text-xs sm:text-sm",children:"Cette recommandation constitue une base solide pour votre projet. Un conseiller certifié peut vous accompagner pour la valider et affiner votre stratégie."})]}),e.jsx("div",{className:"bg-slate-900/80 border border-yellow-500/50 rounded-lg sm:rounded-xl p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[e.jsx(K,{className:"w-5 h-5 sm:w-6 sm:h-6 text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-xs sm:text-sm text-yellow-100",children:[e.jsx("p",{className:"font-semibold mb-1 sm:mb-2",children:"Avertissement important"}),e.jsx("p",{className:"leading-relaxed",children:"Les investissements en SCPI présentent un risque de perte en capital et une liquidité non garantie. Les performances passées ne préjugent pas des performances futures. Cette recommandation est indicative et ne constitue pas un engagement contractuel ni une promesse de rendement. Durée de placement recommandée : 8 à 10 ans minimum."})]})]})}),e.jsxs("div",{className:"mt-4 sm:mt-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[e.jsxs("button",{type:"button",onClick:l=>{l.preventDefault(),l.stopPropagation(),B(l)},style:{position:"relative",zIndex:1e3,pointerEvents:"auto"},className:"flex-1 px-4 sm:px-6 py-3 sm:py-4 rounded-lg sm:rounded-xl bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white text-sm sm:text-base font-bold transition-colors flex items-center justify-center gap-2 shadow-lg shadow-green-500/20 hover:shadow-green-500/30",children:[e.jsx(H,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"hidden sm:inline",children:"Prendre RDV avec un conseiller"}),e.jsx("span",{className:"sm:hidden",children:"Prendre RDV"})]}),e.jsx("button",{type:"button",disabled:C||!s||s.length===0,onClick:async l=>{if(l.preventDefault(),l.stopPropagation(),!(C||!s||s.length===0))try{await G(l)}catch(g){console.error("Erreur dans handleStartSubscription:",g),alert("Erreur lors de l'ouverture du tunnel: "+(g instanceof Error?g.message:String(g)))}},style:{position:"relative",zIndex:1e3,pointerEvents:C||!s||s.length===0?"none":"auto"},className:"flex-1 px-4 sm:px-6 py-3 sm:py-4 rounded-lg sm:rounded-xl bg-emerald-600 hover:bg-emerald-700 disabled:bg-slate-600 disabled:cursor-not-allowed text-white text-sm sm:text-base font-bold transition-colors flex items-center justify-center gap-2 shadow-lg shadow-emerald-500/20 hover:shadow-emerald-500/30 disabled:shadow-none",children:C?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 sm:w-5 sm:h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"Ouverture du tunnel de souscription..."}),e.jsx("span",{className:"sm:hidden",children:"Ouverture..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"hidden sm:inline",children:"Commencer ma souscription en ligne"}),e.jsx("span",{className:"sm:hidden",children:"Souscription"}),e.jsx(_,{className:"w-4 h-4 sm:w-5 sm:h-5"})]})})]}),e.jsx("p",{className:"text-xs text-slate-400 text-center mt-2 sm:mt-3 px-2",children:"Accédez au formulaire de souscription avec votre portefeuille pré-rempli"})]})]})]})})},Ie=({onClose:r,onStartSubscription:c,onCalendlyClick:m})=>{const n=(()=>{const i=window.location.pathname,h=i.includes("/parcours-guide/resultats")||i.includes("/guided-journey/resultats");try{const w=sessionStorage.getItem("guidedJourneyState");if(w&&h){const a=JSON.parse(w);if(a.step==="results"&&a.recommendation&&a.answers)return{step:a.step,recommendation:a.recommendation,answers:a.answers}}}catch{}return{step:"questionnaire",recommendation:null,answers:null}})(),[u,b]=v.useState(n.step),[p,f]=v.useState(n.recommendation),[j,s]=v.useState(n.answers);v.useEffect(()=>{const i=window.location.pathname,h=i.includes("/parcours-guide/resultats")||i.includes("/guided-journey/resultats");if(h&&u==="questionnaire")try{const w=sessionStorage.getItem("guidedJourneyState");if(w){const a=JSON.parse(w);a.step==="results"&&a.recommendation&&a.answers&&(b("results"),f(a.recommendation),s(a.answers))}}catch{}else!h&&u==="results"&&(b("questionnaire"),f(null),s(null),sessionStorage.removeItem("guidedJourneyState"))},[]);const d=i=>{const h=ce(i,I);try{sessionStorage.setItem("guidedJourneyState",JSON.stringify({step:"results",recommendation:h,answers:i}))}catch{}f(h),s(i),b("results"),window.history.pushState({},"","/parcours-guide/resultats"),window.scrollTo({top:0,behavior:"smooth"})},t=()=>{b("questionnaire");try{sessionStorage.removeItem("guidedJourneyState"),window.history.pushState({},"","/parcours-guide")}catch(i){console.error("Erreur lors du nettoyage du state:",i)}};return u==="results"&&p&&j?e.jsx(ve,{recommendation:p,answers:j,onBack:t,onStartSubscription:c,onCalendlyClick:m}):e.jsx(me,{onComplete:d,onClose:r})};export{Ie as default};

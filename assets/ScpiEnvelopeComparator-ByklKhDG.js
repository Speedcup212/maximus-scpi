import{r as m,j as e}from"./index-CRFhanc3.js";import{v as Qe,N as Xe,I as Z,y as xe,k as me,S as Ne,$ as ke,T as pe,E as Je}from"./App-CTFBvRA4.js";import{T as Ze}from"./trash-2-B8yRvSX7.js";import{P as we}from"./plus-Cq-lZNKz.js";import{s as et}from"./scpiData-D5apm83g.js";import{C as ge}from"./chevron-up-C51G6gCf.js";import{R as Ce,C as Se,X as Fe,Y as Ie,T as Pe}from"./CartesianChart-B2qU--T2.js";import{B as Re,a as Ae,C as Ee}from"./BarChart-BnML-akf.js";const tt=({scpis:u,montantTotal:t,portfolio:d,onChangePortfolio:o})=>{const[s,i]=m.useState(""),[x,c]=m.useState(!1),g=r=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR",minimumFractionDigits:0,maximumFractionDigits:0}).format(r),a=d.map(r=>r.scpiId),l=u.filter(r=>!a.includes(r.id)),b=m.useMemo(()=>{if(!s)return l;const r=s.toLowerCase();return l.filter(p=>p.name.toLowerCase().includes(r)||p.company.toLowerCase().includes(r))},[s,l]),y=r=>{const p={scpiId:r.id,scpiName:r.name,rendementBrut:r.rendementBrut,weightPercent:0,weightAmount:0};o([...d,p]),i(""),c(!1)},f=r=>{const p=d.filter((j,A)=>A!==r);o(p)},v=(r,p)=>{const j=[...d];j[r].weightPercent=p,j[r].weightAmount=p/100*t,o(j)},h=(r,p)=>{const j=[...d];j[r].weightAmount=p,j[r].weightPercent=t>0?p/t*100:0,o(j)},F=()=>{if(d.length===0)return;const r=100/d.length,p=d.map(j=>({...j,weightPercent:r,weightAmount:r/100*t}));o(p)},k=d.reduce((r,p)=>r+p.weightPercent,0),P=d.reduce((r,p)=>r+p.weightAmount,0);return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:[e.jsx("strong",{children:"Construisez un portefeuille"})," à partir des SCPI disponibles.",e.jsx("br",{}),"Les rendements utilisés sont les derniers taux de distribution connus pour chaque SCPI. Ils ne sont pas garantis et sont utilisés uniquement comme base de travail pour la simulation."]})}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Qe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"}),e.jsx("input",{type:"text",placeholder:"Rechercher une SCPI (nom, gestionnaire)...",value:s,onChange:r=>{i(r.target.value),c(!0)},onFocus:()=>c(!0),className:"w-full pl-10 pr-3 py-3 rounded-lg border-2 border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:outline-none"})]}),x&&s&&b.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 max-h-64 overflow-y-auto z-50",children:b.slice(0,10).map(r=>e.jsxs("button",{onClick:()=>y(r),className:"w-full text-left px-4 py-3 hover:bg-blue-50 dark:hover:bg-gray-700 border-b border-gray-100 dark:border-gray-700 last:border-0",children:[e.jsx("div",{className:"font-semibold text-gray-900 dark:text-white text-sm",children:r.name}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:[r.company," • Rendement ",r.rendementBrut,"%"]})]},r.id))})]}),d.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-3",children:d.map((r,p)=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border-2 border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 dark:text-white text-sm",children:r.scpiName}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:["Rendement : ",r.rendementBrut,"%"]})]}),e.jsx("button",{onClick:()=>f(p),className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors","aria-label":"Supprimer",children:e.jsx(Ze,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Poids (%)"}),e.jsx("input",{type:"number",value:r.weightPercent.toFixed(2),onChange:j=>v(p,parseFloat(j.target.value)||0),min:0,max:100,step:1,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Montant (€)"}),e.jsx("input",{type:"number",value:Math.round(r.weightAmount),onChange:j=>h(p,parseFloat(j.target.value)||0),min:0,step:1e3,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none"})]})]})]},`${r.scpiId}-${p}`))}),e.jsx("div",{className:"flex items-center justify-between pt-2",children:e.jsxs("button",{onClick:F,className:"flex items-center gap-2 px-4 py-2 text-sm bg-blue-100 hover:bg-blue-200 dark:bg-blue-900/30 dark:hover:bg-blue-800/40 text-blue-700 dark:text-blue-400 rounded-lg transition-colors font-medium",children:[e.jsx(we,{className:"w-4 h-4"}),"Répartir équitablement"]})}),e.jsx("div",{className:`rounded-lg p-4 border-2 ${Math.abs(k-100)<.01?"bg-green-50 dark:bg-green-900/20 border-green-500 dark:border-green-700":"bg-amber-50 dark:bg-amber-900/20 border-amber-500 dark:border-amber-700"}`,children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Total alloué :"}),e.jsxs("span",{className:`font-bold ${Math.abs(k-100)<.01?"text-green-700 dark:text-green-400":"text-amber-700 dark:text-amber-400"}`,children:[k.toFixed(2)," % • ",g(P)]})]}),Math.abs(k-100)>.01&&e.jsxs("div",{className:"flex items-start gap-2 text-xs text-amber-700 dark:text-amber-400",children:[e.jsx(Xe,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),e.jsxs("span",{children:["Le total doit être égal à 100% (",g(t),"). Différence : ",(100-k).toFixed(2),"%"]})]})]})})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-800 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600",children:[e.jsx(we,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Aucune SCPI sélectionnée"}),e.jsx("p",{className:"text-xs mt-1",children:"Utilisez la barre de recherche ci-dessus pour ajouter des SCPI"})]})]})};function st(u,t,d){if(u.length===0||d===0)return{montantTotal:0,rendementBrutMoyen:0,revaloMoyenne:0,partFrance:100,partEtranger:0};const o=u.reduce((a,l)=>a+l.weightPercent,0);if(o===0)return{montantTotal:d,rendementBrutMoyen:0,revaloMoyenne:0,partFrance:100,partEtranger:0};let s=0,i=0,x=0,c=0;u.forEach(a=>{const l=t.find(y=>y.id===a.scpiId);if(!l)return;const b=a.weightPercent/o;s+=b*l.rendementBrut,i+=b*l.revaloMoyenne,x+=b*l.partFrance,c+=b*l.partEtranger});const g=x+c;return g>0?(x=x/g*100,c=c/g*100):(x=100,c=0),{montantTotal:d,rendementBrutMoyen:s,revaloMoyenne:i,partFrance:x,partEtranger:c}}function at(u,t,d,o=100){return{montantTotal:u,rendementBrutMoyen:t,revaloMoyenne:d,partFrance:o,partEtranger:100-o}}const _=({label:u,value:t,onChange:d,min:o,max:s,step:i,unit:x="",tooltip:c,formatValue:g,className:a=""})=>{const l=g?g(t):`${t}${x}`,b=f=>{const v=Number(f.target.value);d(v)},y=f=>{const v=Number(f.target.value),h=Math.min(Math.max(v,o),s);d(h)};return e.jsxs("div",{className:`space-y-2 ${a}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-200",children:[e.jsx("span",{children:u}),c&&e.jsxs("div",{className:"group relative",children:[e.jsx(Z,{className:"w-4 h-4 text-gray-400 cursor-help"}),e.jsx("div",{className:"invisible group-hover:visible absolute left-0 top-6 w-72 p-3 bg-gray-900 text-white text-xs rounded shadow-lg z-10",children:c})]})]}),e.jsx("span",{className:"text-sm font-semibold text-blue-600 dark:text-blue-400",children:l})]}),e.jsx("input",{type:"range",min:o,max:s,step:i,value:t,onChange:b,className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 accent-blue-600"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("span",{children:g?g(o):`${o}${x}`}),e.jsx("span",{children:g?g(s):`${s}${x}`})]}),e.jsx("input",{type:"number",min:o,max:s,step:i,value:t,onChange:y,className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})},rt=[{value:0,label:"0%",description:"Non imposable"},{value:11,label:"11%",description:"Tranche 1"},{value:30,label:"30%",description:"Tranche 2"},{value:41,label:"41%",description:"Tranche 3"},{value:45,label:"45%",description:"Tranche 4"}],nt=({value:u,onChange:t,label:d="Tranche marginale d'imposition (TMI)",className:o=""})=>e.jsxs("div",{className:`space-y-2 ${o}`,children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:d}),e.jsx("select",{value:u,onChange:s=>t(Number(s.target.value)),className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:rt.map(s=>e.jsxs("option",{value:s.value,children:[s.label," - ",s.description]},s.value))})]}),C=({label:u,value:t,onChange:d,min:o,max:s,step:i=.01,unit:x="",tooltip:c,placeholder:g,className:a=""})=>{const l=b=>{const y=Number(b.target.value);o!==void 0&&y<o||s!==void 0&&y>s||d(y)};return e.jsxs("div",{className:`space-y-2 ${a}`,children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-200",children:[e.jsx("span",{children:u}),c&&e.jsxs("div",{className:"group relative",children:[e.jsx(Z,{className:"w-4 h-4 text-gray-400 cursor-help"}),e.jsx("div",{className:"invisible group-hover:visible absolute left-0 top-6 w-72 p-3 bg-gray-900 text-white text-xs rounded shadow-lg z-10",children:c})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",min:o,max:s,step:i,value:t,onChange:l,placeholder:g,className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),x&&e.jsx("span",{className:"absolute right-3 top-2 text-sm text-gray-500 dark:text-gray-400",children:x})]})]})},Me=.055,Be=.065,it=0,lt=0,Te=[{id:"FR_100",label:"100 % France",description:"Patrimoine immobilier exclusivement français",partFrance:1,partEurope:0},{id:"EU_100",label:"100 % Europe",description:"Patrimoine immobilier exclusivement européen (hors France)",partFrance:0,partEurope:1},{id:"FR50_EU50",label:"50 % France / 50 % Europe",description:"Répartition équilibrée France/Europe",partFrance:.5,partEurope:.5},{id:"FR70_EU30",label:"70 % France / 30 % Europe",description:"Dominante française avec diversification européenne",partFrance:.7,partEurope:.3},{id:"FR30_EU70",label:"30 % France / 70 % Europe",description:"Dominante européenne avec ancrage français",partFrance:.3,partEurope:.7}];function dt(u){const{geoScenario:t,grossYieldFrance:d=Me,grossYieldEurope:o=Be,revalFrance:s=it,revalEurope:i=lt}=u,{partFrance:x,partEurope:c}=t,g=x*d+c*o,a=x*s+c*i;return{grossYieldWeighted:g,revalWeighted:a,partFrance:x,partEurope:c,grossYieldFranceUsed:d,grossYieldEuropeUsed:o}}function ot(u){const t=Te.find(d=>d.id===u);if(!t)throw new Error(`Scénario géographique introuvable : ${u}`);return t}function ct(u,t,d){return u*Math.pow(1+t,d)}function ut(u,t,d,o){const s=ct(u,d,o),i=s*(1-t),x=s-i;return{grossValue:s,ecartAmount:x,netValue:i}}function he(u){if(u.length<2)return null;const t=100,d=1e-4;let o=.1;for(let s=0;s<t;s++){let i=0,x=0;for(let c=0;c<u.length;c++)i+=u[c]/Math.pow(1+o,c),x-=c*u[c]/Math.pow(1+o,c+1);if(Math.abs(i)<d)return o*100;if(Math.abs(x)<1e-10||(o=o-i/x,o<-.99||o>10))break}return null}function xt(u){const{montantInvesti:t,rendementBrut:d,revaloPrixPart:o,duree:s,tmi:i,prelevementsSociaux:x,fraisEntree:c,partFrance:g}=u,a=t,l=[-t];let b=0,y=0,f=0,v=0;for(let r=1;r<=s;r++){const p=a*(d/100);b+=p;const j=p*(i/100);f+=j;const R=p*(g/100)*(x/100);v+=R;const L=j+R,I=p-L;y+=I,l.push(I)}const h=ut(t,c/100,o/100,s);l[l.length-1]=l[l.length-1]+h.netValue;const F=he(l),k=y+h.netValue-t,P=k/(t*s)*100;return{envelopeType:"direct",investissement:{montantInvesti:t,coutsInitiaux:0,detailsCoutsInitiaux:[],capitalProductifInitial:a},flux:{revenusBrutsCumules:b,revenusNetsCumules:y,fraisRecurrentsCumules:0,detailsFraisRecurrents:[],impotRevenusCumules:f+v,detailsImpots:[{label:"Impôt sur le revenu",montant:f},{label:"Prélèvements sociaux",montant:v}]},patrimoineFinal:{capitalFinalBrut:h.grossValue,fiscaliteSortie:0,capitalFinalNet:h.netValue},synthese:{gainNetGlobal:k,rendementNetMoyenAnnuel:P,tri:F},capitalBreakdown:{montantInvesti:t,valeurBruteHorizon:h.grossValue,ecartSouscriptionRetrait:c,ecartAmount:h.ecartAmount,capitalNetRecupere:h.netValue}}}function mt(u){const{montantInvesti:t,rendementBrut:d,revaloPrixPart:o,duree:s,fraisEntreeAV:i,fraisGestionAV:x,contractAgeYears:c,householdStatus:g,usedAbatement:a,avTaxMode:l,customAvTaxRate:b,tauxReversementAssureur:y,fraisGestionUcScpi:f}=u,v=t*(i/100);let h=t-v;const F=h,k=[-t];let P=0,r=0;for(let S=1;S<=s;S++){const M=h*(d/100)*(y/100);P+=M;const B=h*(f/100),T=h*(x/100),q=B+T;r+=q;const Y=M-q;h=h+Y,h=h*(1+o/100),S<s&&k.push(0)}const p=Math.max(h-t,0);let j=0;if(p>0){let S;l==="custom"?S=b/100:c<8?S=.3:S=.247;let E=0;c>=8&&l==="auto"&&(E=g==="single"?4600:9200);const M=Math.max(E-a,0);j=Math.max(p-M,0)*S}const A=h-j;k.push(A);const R=he(k),L=A-t,I=L/(t*s)*100;return{envelopeType:"assurance_vie",investissement:{montantInvesti:t,coutsInitiaux:v,detailsCoutsInitiaux:[{label:"Frais sur versement",montant:v}],capitalProductifInitial:F},flux:{revenusBrutsCumules:P,revenusNetsCumules:0,fraisRecurrentsCumules:r,detailsFraisRecurrents:[{label:"Frais de gestion UC du contrat AV",montant:r}],impotRevenusCumules:j,detailsImpots:[{label:"Fiscalité de sortie sur le gain (IR + PS, après abattement et ancienneté)",montant:j}]},patrimoineFinal:{capitalFinalBrut:h,fiscaliteSortie:j,capitalFinalNet:A},synthese:{gainNetGlobal:L,rendementNetMoyenAnnuel:I,tri:R}}}function pt(u){const{montantInvesti:t,rendementBrut:d,revaloPrixPart:o,duree:s,tauxIS:i,tauxDistribution:x,fraisSCIAnnuels:c,partFrance:g,apportCapital:a,apportCompteCourant:l}=u;let b=t,y=0;const f=[-t];let v=0,h=0,F=0,k=0,P=0,r=0;for(let I=1;I<=s;I++){const S=b*(d/100);v+=S,k+=c;const E=S-c,M=Math.max(E,0)*(i/100);P+=M;const B=E-M,T=Math.max(B,0)*(x/100);h+=T;const q=T*(g/100),Y=T*.128,z=q*.172,W=Y+z;r+=W;const U=T-W;F+=U;const ee=B-T;if(y+=ee,b=b*(1+o/100),I<s)f.push(U);else{const O=b+y;f.push(U+O)}}const p=b+y,j=Math.min(l,y),A=he(f),R=F+p-t,L=R/(t*s)*100;return{envelopeType:"sci_is",investissement:{montantInvesti:t,coutsInitiaux:0,detailsCoutsInitiaux:[{label:"Apport en capital social",montant:a},{label:"Apport en compte courant d'associé",montant:l}],capitalProductifInitial:t},flux:{revenusBrutsCumules:v,revenusNetsCumules:F,dividendesBrutsCumules:h,dividendesNetsCumules:F,fraisRecurrentsCumules:k,detailsFraisRecurrents:[{label:"Frais structure SCI / comptabilité",montant:k}],impotRevenusCumules:P+r,detailsImpots:[{label:"Impôt sur les sociétés (IS)",montant:P},{label:"Fiscalité sur dividendes (PFU)",montant:r}],remboursementCCA:j},patrimoineFinal:{capitalFinalBrut:p,fiscaliteSortie:0,capitalFinalNet:p},synthese:{gainNetGlobal:R,rendementNetMoyenAnnuel:L,tri:A}}}const be=({result:u,color:t,icon:d,title:o})=>{const{investissement:s,flux:i,patrimoineFinal:x,synthese:c,envelopeType:g}=u,a=l=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR",minimumFractionDigits:0,maximumFractionDigits:0}).format(l);return s.coutsInitiaux>0&&(s.coutsInitiaux/s.montantInvesti*100).toFixed(1),s.montantInvesti-s.coutsInitiaux,e.jsxs("div",{className:`${t.bg} rounded-xl shadow-lg p-6 border-2 ${t.border} space-y-5`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:t.icon,children:d}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:o})]}),e.jsxs("section",{className:"space-y-2",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide border-b border-gray-200 dark:border-gray-700 pb-1",children:"Investissement & coûts initiaux"}),e.jsxs("div",{className:"space-y-1.5 text-sm",children:[g==="direct"&&u.capitalBreakdown&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 -mx-4 px-4 py-3 space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300 text-xs",children:"Montant investi (base de calcul des revenus)"}),e.jsx("span",{className:"font-bold text-gray-900 dark:text-white text-base",children:a(u.capitalBreakdown.montantInvesti)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300 text-xs",children:"Valeur brute théorique à l'horizon"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:a(u.capitalBreakdown.valeurBruteHorizon)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-300 text-xs",children:["Écart souscription/retrait (",u.capitalBreakdown.ecartSouscriptionRetrait,"%)"]}),e.jsxs("span",{className:"font-semibold text-red-600 dark:text-red-400",children:["−",a(u.capitalBreakdown.ecartAmount)]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-200 text-sm",children:"Capital net récupéré en cas de revente"}),e.jsx("span",{className:`font-bold ${t.text} text-base`,children:a(u.capitalBreakdown.capitalNetRecupere)})]}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 italic bg-white/50 dark:bg-gray-800/50 p-2 rounded mt-2",children:["Les ",a(u.capitalBreakdown.montantInvesti)," sont intégralement investis et servent de base au calcul des loyers. L'écart souscription/retrait n'impacte pas les revenus annuels mais uniquement le capital net récupéré en cas de revente."]})]}),g==="assurance_vie"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Montant investi"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:a(s.montantInvesti)})]}),e.jsxs("div",{className:"flex justify-between text-red-600 dark:text-red-400",children:[e.jsx("span",{children:"Coûts initiaux totaux"}),e.jsx("span",{className:"font-semibold",children:a(s.coutsInitiaux)})]}),s.detailsCoutsInitiaux.map((l,b)=>e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 pl-4",children:[e.jsxs("span",{children:["• ",l.label]}),e.jsx("span",{children:a(l.montant)})]},b)),e.jsxs("div",{className:"flex justify-between pt-1 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-200",children:"Capital réellement investi sur la SCPI"}),e.jsx("span",{className:`font-bold ${t.text}`,children:a(s.capitalProductifInitial)})]})]}),g==="sci_is"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Montant investi"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:a(s.montantInvesti)})]}),s.coutsInitiaux>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-red-600 dark:text-red-400",children:[e.jsx("span",{children:"Coûts initiaux totaux"}),e.jsx("span",{className:"font-semibold",children:a(s.coutsInitiaux)})]}),s.detailsCoutsInitiaux.map((l,b)=>e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 pl-4",children:[e.jsxs("span",{children:["• ",l.label]}),e.jsx("span",{children:a(l.montant)})]},b))]}),e.jsxs("div",{className:"flex justify-between pt-1 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-200",children:"Capital investi en SCPI dans la SCI"}),e.jsx("span",{className:`font-bold ${t.text}`,children:a(s.capitalProductifInitial)})]})]})]})]}),e.jsxs("section",{className:"space-y-2",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide border-b border-gray-200 dark:border-gray-700 pb-1",children:"Revenus, charges & fiscalité (sur la période)"}),e.jsx("div",{className:"space-y-1.5 text-sm",children:g==="assurance_vie"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Revenus bruts cumulés (à l'intérieur du contrat)"}),e.jsx("span",{className:"font-semibold text-green-600 dark:text-green-400",children:a(i.revenusBrutsCumules)})]}),e.jsxs("div",{className:"flex justify-between text-orange-600 dark:text-orange-400",children:[e.jsx("span",{children:"Frais récurrents cumulés"}),e.jsx("span",{className:"font-semibold",children:a(i.fraisRecurrentsCumules)})]}),i.detailsFraisRecurrents.map((l,b)=>e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 pl-4",children:[e.jsxs("span",{children:["• ",l.label]}),e.jsx("span",{children:a(l.montant)})]},b)),e.jsxs("div",{className:"flex justify-between pt-1 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-200",children:"Revenus nets perçus pendant la période"}),e.jsx("span",{className:"font-bold text-gray-900 dark:text-white",children:a(0)})]}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 italic bg-gray-50 dark:bg-gray-800 p-2 rounded mt-2",children:"Dans cette simulation, les revenus de la SCPI sont intégralement capitalisés dans le contrat d'assurance-vie. Aucun flux n'est perçu avant le rachat."}),x.fiscaliteSortie>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-red-600 dark:text-red-400 pt-2",children:[e.jsx("span",{children:"Impôts cumulés"}),e.jsx("span",{className:"font-semibold",children:a(x.fiscaliteSortie)})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 pl-4",children:[e.jsx("span",{children:"• Fiscalité de sortie sur le gain (taux moyen)"}),e.jsx("span",{children:a(x.fiscaliteSortie)})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Revenus bruts cumulés"}),e.jsx("span",{className:"font-semibold text-green-600 dark:text-green-400",children:a(i.revenusBrutsCumules)})]}),i.fraisRecurrentsCumules>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-orange-600 dark:text-orange-400",children:[e.jsx("span",{children:"Frais récurrents cumulés"}),e.jsx("span",{className:"font-semibold",children:a(i.fraisRecurrentsCumules)})]}),i.detailsFraisRecurrents.map((l,b)=>e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 pl-4",children:[e.jsxs("span",{children:["• ",l.label]}),e.jsx("span",{children:a(l.montant)})]},b))]}),i.impotRevenusCumules>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-red-600 dark:text-red-400",children:[e.jsx("span",{children:"Impôts cumulés"}),e.jsx("span",{className:"font-semibold",children:a(i.impotRevenusCumules)})]}),i.detailsImpots.map((l,b)=>e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 pl-4",children:[e.jsxs("span",{children:["• ",l.label]}),e.jsx("span",{children:a(l.montant)})]},b))]}),e.jsxs("div",{className:"flex justify-between pt-1 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-200",children:g==="sci_is"?"Revenus nets perçus (dividendes nets cumulés)":"Revenus nets perçus"}),e.jsx("span",{className:`font-bold ${t.text}`,children:a(i.revenusNetsCumules)})]}),g==="sci_is"&&e.jsxs(e.Fragment,{children:[i.remboursementCCA!==void 0&&i.remboursementCCA>0&&e.jsxs("div",{className:"flex justify-between pt-2 text-blue-600 dark:text-blue-400",children:[e.jsx("span",{className:"font-medium",children:"Dont remboursement de compte courant (non fiscalisé)"}),e.jsx("span",{className:"font-semibold",children:a(i.remboursementCCA)})]}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 italic bg-gray-50 dark:bg-gray-800 p-2 rounded mt-2",children:["Les dividendes nets cumulés correspondent aux flux effectivement perçus par l'associé. Le reste de la performance est logé dans la valeur de la SCPI et la trésorerie de la SCI.",i.remboursementCCA!==void 0&&i.remboursementCCA>0&&e.jsx(e.Fragment,{children:" L'apport en compte courant d'associé est remboursable sans fiscalité au niveau de l'associé."})]})]})]})})]}),e.jsxs("section",{className:"space-y-2",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide border-b border-gray-200 dark:border-gray-700 pb-1",children:"Résultat net & rendement"}),e.jsxs("div",{className:"space-y-1.5 text-sm",children:[g==="assurance_vie"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Capital final brut"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:a(x.capitalFinalBrut)})]}),e.jsxs("div",{className:"flex justify-between text-red-600 dark:text-red-400",children:[e.jsx("span",{children:"Fiscalité de sortie estimée"}),e.jsx("span",{className:"font-semibold",children:a(x.fiscaliteSortie)})]}),e.jsxs("div",{className:"flex justify-between pt-1 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-200",children:"Capital final net"}),e.jsx("span",{className:"font-bold text-gray-900 dark:text-white",children:a(x.capitalFinalNet)})]})]}):e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-300",children:["Capital final net ",g==="direct"?"(hors fiscalité de plus-value, non modélisée)":"(hors fiscalité de liquidation, non modélisée)"]}),e.jsx("span",{className:"font-bold text-gray-900 dark:text-white",children:a(x.capitalFinalNet)})]}),e.jsxs("div",{className:`flex justify-between pt-2 mt-2 border-t-2 ${t.border}`,children:[e.jsx("span",{className:"font-bold text-gray-900 dark:text-white",children:"Gain net global"}),e.jsx("span",{className:`font-bold text-xl ${t.text}`,children:a(c.gainNetGlobal)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:"Rendement net moyen / an"}),e.jsxs("span",{className:`text-sm font-bold ${t.text}`,children:[c.rendementNetMoyenAnnuel.toFixed(2)," %"]})]}),c.tri!==null&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:"TRI estimé"}),e.jsxs("span",{className:`text-sm font-bold ${t.text}`,children:[c.tri.toFixed(2)," % / an"]})]})]})]})]})},wt=({defaultAmount:u=1e5,defaultYield:t=0,defaultDuration:d=15,ctaUrl:o="#contact",onCtaClick:s})=>{const[i,x]=m.useState("manuel"),[c,g]=m.useState([]),[a,l]=m.useState(u),[b,y]=m.useState(t),[f,v]=m.useState(0),[h,F]=m.useState(d),[k,P]=m.useState(100),[r,p]=m.useState("FR70_EU30"),[j,A]=m.useState(Me*100),[R,L]=m.useState(Be*100),[I,S]=m.useState(30),[E,M]=m.useState(17.2),[B,T]=m.useState(!0),[q,Y]=m.useState(10),[z,W]=m.useState(!0),[U,ee]=m.useState(2),[O,De]=m.useState(.8),[Le,gt]=m.useState(15),[te,qe]=m.useState(10),[K,je]=m.useState("couple"),[se,$e]=m.useState(0),[H,ye]=m.useState("auto"),[ae,Ue]=m.useState(25),[re,Ve]=m.useState(90),[ne,Ge]=m.useState(.8),[ie,_e]=m.useState(!0),[le,Ye]=m.useState(25),[de,ze]=m.useState(50),[oe,Oe]=m.useState(1500),[V,He]=m.useState(1e5),[G,We]=m.useState(0),ce=n=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),Q=m.useMemo(()=>et.map(n=>{let w=100,X=0;if(n.repartitionGeo&&n.repartitionGeo.length>0){const J=n.repartitionGeo.filter(ue=>ue.name.toLowerCase().includes("france")).reduce((ue,Ke)=>ue+Ke.value,0);w=J,X=100-J}return{id:n.id.toString(),name:n.name,rendementBrut:n.yield,revaloMoyenne:0,partFrance:w,partEtranger:X,company:n.company,disponibleAssuranceVie:!0,disponibleSciIs:!0}}),[]),$=m.useMemo(()=>{const n=ot(r);return dt({geoScenario:n,grossYieldFrance:j/100,grossYieldEurope:R/100,revalFrance:0,revalEurope:0})},[r,j,R]),N=m.useMemo(()=>i==="scpi"?st(c,Q,a):at(a,$.grossYieldWeighted*100,f,$.partFrance*100),[i,c,Q,a,$,f]),D=m.useMemo(()=>{const n=xt({montantInvesti:N.montantTotal,rendementBrut:N.rendementBrutMoyen,revaloPrixPart:N.revaloMoyenne,duree:h,tmi:I,prelevementsSociaux:E,fraisEntree:q,partFrance:N.partFrance}),w=mt({montantInvesti:N.montantTotal,rendementBrut:N.rendementBrutMoyen,revaloPrixPart:N.revaloMoyenne,duree:h,fraisEntreeAV:U,fraisGestionAV:O,partFrance:N.partFrance,contractAgeYears:te,householdStatus:K,usedAbatement:se,avTaxMode:H,customAvTaxRate:ae,tauxReversementAssureur:re,fraisGestionUcScpi:ne}),X=V+G,J=pt({montantInvesti:X,rendementBrut:N.rendementBrutMoyen,revaloPrixPart:N.revaloMoyenne,duree:h,tauxIS:le,tauxDistribution:de,fraisSCIAnnuels:oe,partFrance:N.partFrance,apportCapital:V,apportCompteCourant:G});return{direct:n,av:w,sciIS:J}},[N,h,I,E,q,U,O,Le,le,de,oe,te,K,se,H,ae,V,G,re,ne]),fe=[{name:"Direct",TRI:D.direct.synthese.tri||0,color:"#3b82f6"},{name:"Assurance-vie",TRI:D.av.synthese.tri||0,color:"#8b5cf6"},{name:"SCI IS",TRI:D.sciIS.synthese.tri||0,color:"#10b981"}],ve=[{name:"Direct",Capital:D.direct.patrimoineFinal.capitalFinalNet,color:"#3b82f6"},{name:"Assurance-vie",Capital:D.av.patrimoineFinal.capitalFinalNet,color:"#8b5cf6"},{name:"SCI IS",Capital:D.sciIS.patrimoineFinal.capitalFinalNet,color:"#10b981"}];return e.jsx("div",{className:"min-h-screen bg-slate-50 dark:bg-gray-900 py-8 px-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-3",children:"Comparateur d'enveloppes SCPI"}),e.jsxs("p",{className:"text-lg text-gray-600 dark:text-gray-300 max-w-4xl mx-auto",children:["Comparez, à partir d'une même SCPI, l'impact de l'enveloppe de détention sur vos revenus, votre fiscalité et votre rendement global (Direct, Assurance-vie, SCI à l'IS).",e.jsx("br",{}),e.jsx("span",{className:"text-sm italic",children:"Modélisation simplifiée destinée à la pré-analyse et au support de conseil, à affiner au cas par cas."})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-5 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-blue-600",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:[e.jsx(xe,{className:"w-6 h-6 text-blue-600"}),"Bloc 1 – Hypothèses SCPI communes"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6",children:"Définissez le portefeuille SCPI et ses caractéristiques, indépendamment de l'enveloppe"}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg p-4 mb-6 border border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:[e.jsx("strong",{children:"Choisissez d'entrer un rendement moyen global"})," ou de ",e.jsx("strong",{children:"construire un portefeuille réel"})," à partir des SCPI disponibles.",e.jsx("br",{}),"Le comparatif d'enveloppe (Direct / AV / SCI IS) s'applique ensuite sur l'ensemble du portefeuille."]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-3",children:"Mode de saisie"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:`flex items-start gap-3 cursor-pointer p-3 border-2 rounded-lg transition-colors hover:bg-gray-50 dark:hover:bg-gray-700 ${i==="manuel"?"border-blue-600 dark:border-blue-400 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600"}`,children:[e.jsx("input",{type:"radio",value:"manuel",checked:i==="manuel",onChange:n=>x(n.target.value),className:"mt-1"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900 dark:text-white",children:"Portefeuille agrégé (saisie manuelle)"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Entrez directement un rendement et une revalorisation moyens"})]})]}),e.jsxs("label",{className:`flex items-start gap-3 cursor-pointer p-3 border-2 rounded-lg transition-colors hover:bg-gray-50 dark:hover:bg-gray-700 ${i==="scpi"?"border-blue-600 dark:border-blue-400 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600"}`,children:[e.jsx("input",{type:"radio",value:"scpi",checked:i==="scpi",onChange:n=>x(n.target.value),className:"mt-1"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900 dark:text-white",children:"Portefeuille de SCPI (sélection dans la liste)"}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Construisez un portefeuille à partir de ",Q.length," SCPI disponibles"]})]})]})]})]}),e.jsx(_,{label:"Montant investi",value:a,onChange:l,min:1e4,max:2e6,step:1e4,formatValue:n=>ce(n),className:"mb-6"}),i==="scpi"&&e.jsxs("div",{className:"mb-6",children:[e.jsx(tt,{scpis:Q,montantTotal:a,portfolio:c,onChangePortfolio:g}),e.jsxs("div",{className:"mt-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2",children:"Agrégats calculés du portefeuille :"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-700 dark:text-gray-300",children:[e.jsxs("div",{children:["Rendement moyen : ",e.jsxs("strong",{children:[N.rendementBrutMoyen.toFixed(2)," %"]})]}),e.jsxs("div",{children:["Revalorisation moyenne : ",e.jsxs("strong",{children:[N.revaloMoyenne.toFixed(2)," %"]})]}),e.jsxs("div",{children:["Part France : ",e.jsxs("strong",{children:[N.partFrance.toFixed(1)," %"]})]}),e.jsxs("div",{children:["Part Étranger : ",e.jsxs("strong",{children:[N.partEtranger.toFixed(1)," %"]})]})]})]})]}),i==="manuel"&&e.jsx(_,{label:"Rendement brut annuel estimé",value:b,onChange:y,min:0,max:99,step:.1,unit:" %",tooltip:"Hypothèse de rendement brut annuel moyen sur la durée de la simulation. Basé sur les derniers taux de distribution connus de la SCPI. Rendement non garanti, susceptible de varier à la hausse comme à la baisse.",className:"mb-6"}),i==="manuel"&&e.jsx(_,{label:"Revalorisation annuelle du prix de part",value:f,onChange:v,min:-1,max:3,step:.1,formatValue:n=>`${n>0?"+":""}${n.toFixed(1)} %`,tooltip:"Hypothèse de variation moyenne du prix de la part (scénario prudent/neutre/dynamique). 0 % = scénario neutre. Valeur négative = baisse progressive, valeur positive = revalorisation annuelle. Les revalorisations passées ne préjugent pas des revalorisations futures.",className:"mb-6"}),e.jsx(_,{label:"Horizon de projection",value:h,onChange:F,min:5,max:25,step:1,formatValue:n=>`${n} ans`,className:"mb-6"}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 dark:text-white mb-3",children:"Scénario géographique (France / Europe)"}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3 mb-4 text-xs text-gray-700 dark:text-gray-300",children:e.jsxs("p",{children:["Les rendements bruts sont calculés selon la répartition géographique France/Europe.",e.jsx("br",{}),"Rendements par défaut : ",e.jsx("strong",{children:"France 5,5 %"})," / ",e.jsx("strong",{children:"Europe 6,5 %"})]})}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Répartition géographique"}),Te.map(n=>e.jsxs("label",{className:`flex items-start gap-3 cursor-pointer p-3 border-2 rounded-lg transition-colors hover:bg-gray-50 dark:hover:bg-gray-700 ${r===n.id?"border-blue-600 dark:border-blue-400 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600"}`,children:[e.jsx("input",{type:"radio",value:n.id,checked:r===n.id,onChange:w=>p(w.target.value),className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 dark:text-white",children:n.label}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:n.description})]})]},n.id))]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(C,{label:"Rendement brut France",value:j,onChange:A,min:0,max:15,step:.1,unit:"%",tooltip:"Rendement brut annuel des actifs situés en France. Par défaut : 5,5%"}),e.jsx(C,{label:"Rendement brut Europe",value:R,onChange:L,min:0,max:15,step:.1,unit:"%",tooltip:"Rendement brut annuel des actifs situés en Europe (hors France). Par défaut : 6,5%"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-amber-500",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Bloc 2 – Profil fiscal (personne physique)"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6",children:"Fiscalité commune aux calculs Direct / AV / PFU dividendes"}),e.jsx(nt,{value:I,onChange:S,className:"mb-4"}),e.jsx(C,{label:"Prélèvements sociaux",value:E,onChange:M,min:0,max:25,step:.1,unit:"%",tooltip:"Taux des prélèvements sociaux appliqués aux revenus fonciers. Par défaut : 17,2 %"}),e.jsxs("div",{className:"mt-4 bg-amber-50 dark:bg-amber-900/20 rounded-lg p-3 text-xs text-gray-700 dark:text-gray-300",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Régime fiscal (détention directe) :"})," Revenus fonciers simplifiés (TMI + PS sur loyers bruts)."]}),e.jsx("p",{className:"mt-2",children:"Modélisation simplifiée : la base imposable est assimilée aux revenus bruts. Le mécanisme réel (déductions, charges, intérêts d'emprunt, déficit foncier) n'est pas entièrement reproduit."})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-blue-500",children:[e.jsxs("button",{onClick:()=>T(!B),className:"w-full flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(xe,{className:"w-6 h-6 text-blue-600"}),"Bloc 3 – Détention directe"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Paramètres spécifiques à la détention en direct"})]}),B?e.jsx(ge,{className:"w-5 h-5 text-gray-500"}):e.jsx(me,{className:"w-5 h-5 text-gray-500"})]}),B&&e.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3 text-xs text-gray-700 dark:text-gray-300",children:e.jsx("p",{children:"L'écart souscription/retrait modélise les frais d'entrée / de sortie implicites : en cas de revente immédiate, le prix de retrait est inférieur au prix de souscription."})}),e.jsx(C,{label:"Frais d'entrée (écart souscription/retrait)",value:q,onChange:Y,min:0,max:15,step:.5,unit:"%",tooltip:"Écart entre le prix de souscription et le prix de retrait immédiat. Généralement entre 8% et 12% selon les SCPI."})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-purple-500",children:[e.jsxs("button",{onClick:()=>W(!z),className:"w-full flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(Ne,{className:"w-6 h-6 text-purple-600"}),"Bloc 4 – Assurance-vie"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Frais, reversement et fiscalité de sortie AV"})]}),z?e.jsx(ge,{className:"w-5 h-5 text-gray-500"}):e.jsx(me,{className:"w-5 h-5 text-gray-500"})]}),z&&e.jsxs("div",{className:"space-y-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full"}),"Frais & mécanique de rendement"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(C,{label:"Frais sur versement",value:U,onChange:ee,min:0,max:5,step:.1,unit:"%",tooltip:"Frais prélevés sur le versement initial dans le contrat d'assurance-vie."}),e.jsx(C,{label:"Frais de gestion du contrat sur UC",value:O,onChange:De,min:0,max:2,step:.05,unit:"%",tooltip:"Frais annuels de gestion prélevés sur les unités de compte au niveau du contrat AV. Par défaut : 0,80 %"}),e.jsx(C,{label:"Frais de gestion UC SCPI",value:ne,onChange:Ge,min:0,max:2,step:.05,unit:"%",tooltip:"Frais de gestion annuels spécifiques aux UC SCPI (prélevés par l'assureur). Par défaut : 0,80 %"}),e.jsx(_,{label:"Taux de reversement assureur",value:re,onChange:Ve,min:70,max:100,step:1,formatValue:n=>`${n} %`,tooltip:"Pourcentage des revenus SCPI effectivement reversés par l'assureur dans le contrat. Par défaut : 90 %"})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full"}),"Fiscalité de sortie Assurance-vie"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(_,{label:"Ancienneté du contrat à la sortie",value:te,onChange:qe,min:0,max:30,step:1,formatValue:n=>`${n} ans`,tooltip:"Durée d'existence du contrat au moment du rachat. Détermine la fiscalité applicable (avant/après 8 ans).",className:"mb-4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Statut fiscal pour l'abattement"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"single",checked:K==="single",onChange:n=>je(n.target.value),className:"text-purple-600"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Célibataire / Veuf / Divorcé (abattement 4 600 €)"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"couple",checked:K==="couple",onChange:n=>je(n.target.value),className:"text-purple-600"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Couple (imposition commune) (abattement 9 200 €)"})]})]})]}),e.jsx(C,{label:"Abattement déjà utilisé cette année",value:se,onChange:$e,min:0,max:2e4,step:100,unit:"€",tooltip:"Montant d'abattement déjà consommé dans l'année (si plusieurs rachats sur différents contrats)."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Mode de calcul de la fiscalité"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"auto",checked:H==="auto",onChange:n=>ye(n.target.value),className:"text-purple-600"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Calcul automatique (règles avant/après 8 ans)"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"custom",checked:H==="custom",onChange:n=>ye(n.target.value),className:"text-purple-600"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Taux global personnalisé"})]})]})]}),H==="custom"&&e.jsx(C,{label:"Taux global IR + PS sur le gain",value:ae,onChange:Ue,min:0,max:50,step:.5,unit:"%",tooltip:"Taux global personnalisé intégrant IR + prélèvements sociaux sur le gain."}),e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-3 text-xs text-gray-700 dark:text-gray-300",children:[e.jsx("p",{className:"font-semibold mb-2",children:"Fiscalité de sortie Assurance-vie"}),e.jsx("p",{children:"La fiscalité est calculée en fonction de l'ancienneté du contrat, de l'abattement annuel disponible (4 600 € ou 9 200 €) et du mode d'imposition choisi."}),e.jsxs("p",{className:"mt-2",children:[e.jsx("strong",{children:"Avant 8 ans :"})," PFU de 30 % (12,8 % IR + 17,2 % PS) sur le gain taxable."]}),e.jsxs("p",{className:"mt-2",children:[e.jsx("strong",{children:"Après 8 ans :"})," Taux de 24,7 % (7,5 % IR + 17,2 % PS) après imputation de l'abattement disponible."]}),e.jsx("p",{className:"mt-2",children:"Vous pouvez basculer en mode « Taux global personnalisé » pour ajuster manuellement le taux effectif."})]})]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-green-500",children:[e.jsxs("button",{onClick:()=>_e(!ie),className:"w-full flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(ke,{className:"w-6 h-6 text-green-600"}),"Bloc 5 – SCI à l'IS"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Structure de financement, IS, PFU et frais de structure"})]}),ie?e.jsx(ge,{className:"w-5 h-5 text-gray-500"}):e.jsx(me,{className:"w-5 h-5 text-gray-500"})]}),ie&&e.jsxs("div",{className:"space-y-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Structure de financement"]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 space-y-3",children:[e.jsx(C,{label:"Apport en capital (SCI)",value:V,onChange:n=>{He(n);const w=n+G;w!==a&&l(w)},min:0,max:2e6,step:1e3,unit:"€",tooltip:"Montant apporté au capital social de la SCI."}),e.jsx(C,{label:"Apport en compte courant d'associé",value:G,onChange:n=>{We(n);const w=V+n;w!==a&&l(w)},min:0,max:2e6,step:1e3,unit:"€",tooltip:"Montant prêté à la SCI en compte courant d'associé. Remboursable sans fiscalité."}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 pt-2 border-t border-green-200 dark:border-green-700",children:[e.jsx("strong",{children:"Total investi :"})," ",ce(V+G)]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Fiscalité & frais SCI"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(C,{label:"Taux d'IS",value:le,onChange:Ye,min:15,max:33,step:.5,unit:"%",tooltip:"Taux de l'impôt sur les sociétés applicable. Par défaut : 25 %"}),e.jsx(C,{label:"Part du résultat distribué",value:de,onChange:ze,min:0,max:100,step:5,unit:"%",tooltip:"Pourcentage du résultat net après IS distribué en dividendes. Le reste est capitalisé en réserves dans la SCI."}),e.jsx(C,{label:"Frais structure SCI / comptabilité",value:oe,onChange:Oe,min:0,max:5e3,step:100,unit:"€ / an",tooltip:"Coûts annuels de gestion, comptabilité et formalités de la SCI. Par défaut : 1 500 €/an"})]})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3 text-xs text-gray-700 dark:text-gray-300 space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Fiscalité sur dividendes :"})," PFU 30 % (12,8 % IR + 17,2 % PS)"]}),e.jsx("p",{children:"L'apport en compte courant d'associé est remboursable sans fiscalité au niveau de l'associé. Dans cette simulation, la fiscalité de liquidation de la SCI (plus-values latentes, boni de liquidation, etc.) n'est pas modélisée : le capital final net est présenté à titre indicatif comme valeur économique globale de la SCI (SCPI + trésorerie)."})]})]})]})]}),e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border-2 border-amber-200 dark:border-amber-700 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Z,{className:"w-5 h-5 text-amber-600 dark:text-amber-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:"Répartition géographique et rendement harmonisé"}),i==="manuel"&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/30 rounded-lg p-3 mb-2",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-white mb-1",children:"Rendement brut pondéré calculé :"}),e.jsxs("p",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:[($.grossYieldWeighted*100).toFixed(2),"%"]}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:["Basé sur France ",$.grossYieldFranceUsed.toFixed(1),"% × ",($.partFrance*100).toFixed(0),"% + Europe ",$.grossYieldEuropeUsed.toFixed(1),"% × ",($.partEurope*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:e.jsxs("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:["France : ",N.partFrance.toFixed(1),"%"]})}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"PS 17,2% appliqués"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:e.jsxs("span",{className:"font-semibold text-green-600 dark:text-green-400",children:["Europe : ",N.partEtranger.toFixed(1),"%"]})}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"PS 0% (exonération)"})]})]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 italic pt-2 border-t border-amber-200 dark:border-amber-700",children:"Les prélèvements sociaux (17,2 %) sont appliqués uniquement sur la part des revenus de source française. Les revenus de source européenne/internationale sont modélisés sans prélèvements sociaux en France. En pratique, la fiscalité exacte dépend des conventions fiscales et de la documentation de chaque SCPI."})]})]})}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsx(be,{result:D.direct,color:{bg:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/20",border:"border-blue-200 dark:border-blue-700",text:"text-blue-600 dark:text-blue-400",icon:"text-blue-600 dark:text-blue-400"},icon:e.jsx(xe,{className:"w-6 h-6"}),title:"Détention directe"}),e.jsx(be,{result:D.av,color:{bg:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/30 dark:to-purple-800/20",border:"border-purple-200 dark:border-purple-700",text:"text-purple-600 dark:text-purple-400",icon:"text-purple-600 dark:text-purple-400"},icon:e.jsx(Ne,{className:"w-6 h-6"}),title:"Assurance-vie"}),e.jsx(be,{result:D.sciIS,color:{bg:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/30 dark:to-green-800/20",border:"border-green-200 dark:border-green-700",text:"text-green-600 dark:text-green-400",icon:"text-green-600 dark:text-green-400"},icon:e.jsx(ke,{className:"w-6 h-6"}),title:"SCI à l'IS"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5 text-blue-600"}),"TRI par enveloppe"]}),e.jsx(Ce,{width:"100%",height:250,children:e.jsxs(Re,{data:fe,children:[e.jsx(Se,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(Fe,{dataKey:"name",stroke:"#6b7280"}),e.jsx(Ie,{stroke:"#6b7280"}),e.jsx(Pe,{formatter:n=>`${n.toFixed(2)} %`,contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #e5e7eb",borderRadius:"8px"}}),e.jsx(Ae,{dataKey:"TRI",name:"TRI (%)",children:fe.map((n,w)=>e.jsx(Ee,{fill:n.color},`cell-${w}`))})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(Je,{className:"w-5 h-5 text-green-600"}),"Capital net final"]}),e.jsx(Ce,{width:"100%",height:250,children:e.jsxs(Re,{data:ve,children:[e.jsx(Se,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(Fe,{dataKey:"name",stroke:"#6b7280"}),e.jsx(Ie,{stroke:"#6b7280"}),e.jsx(Pe,{formatter:n=>ce(n),contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #e5e7eb",borderRadius:"8px"}}),e.jsx(Ae,{dataKey:"Capital",name:"Capital (€)",children:ve.map((n,w)=>e.jsx(Ee,{fill:n.color},`cell-${w}`))})]})})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl shadow-lg p-6 text-white text-center",children:[e.jsx("h3",{className:"text-xl font-bold mb-2",children:"Optimisez votre stratégie patrimoniale"}),e.jsx("p",{className:"text-blue-100 mb-4",children:"Bénéficiez d'une analyse personnalisée pour choisir la meilleure enveloppe selon votre profil"}),s?e.jsxs("button",{onClick:s,className:"inline-flex items-center gap-2 bg-white text-blue-600 font-semibold px-6 py-3 rounded-lg hover:bg-blue-50 transition-colors",children:[e.jsx(pe,{className:"w-5 h-5"}),"Demander une étude personnalisée"]}):e.jsxs("a",{href:o,className:"inline-flex items-center gap-2 bg-white text-blue-600 font-semibold px-6 py-3 rounded-lg hover:bg-blue-50 transition-colors",children:[e.jsx(pe,{className:"w-5 h-5"}),"Demander une étude personnalisée"]})]}),e.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 rounded-xl border-2 border-amber-200 dark:border-amber-800 p-6",children:[e.jsxs("h4",{className:"font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5 text-amber-600"}),"Mentions importantes - Modèle simplifié CGP"]}),e.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-3 leading-relaxed",children:[e.jsx("p",{className:"font-semibold text-amber-900 dark:text-amber-200",children:"⚠️ Simulation à titre indicatif, basée sur des hypothèses simplifiées de rendement, de frais et de fiscalité"}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 space-y-2",children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:"Les calculs ne prennent pas en compte :"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[e.jsx("li",{children:"L'ensemble des règles fiscales applicables (déficit foncier, abattements spécifiques, tranches d'IS/IR détaillées)"}),e.jsx("li",{children:"La fiscalité des plus-values immobilières (détention directe et SCI)"}),e.jsx("li",{children:"La fiscalité de liquidation de la SCI à l'IS"}),e.jsx("li",{children:"Les frais de création de SCI"}),e.jsx("li",{children:"Les spécificités contractuelles de chaque contrat d'assurance-vie"})]})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Objectif de cette comparaison :"})," Illustrer l'impact des enveloppes de détention (Direct, Assurance-vie, SCI à l'IS) sur des hypothèses homogènes pour faciliter la décision stratégique. Cette simulation ne remplace pas une étude fiscale personnalisée complète."]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Les taux utilisés (rendement, fiscalité, frais) sont des hypothèses de travail et ne constituent pas un engagement contractuel. Les SCPI présentent un risque de perte en capital, une liquidité limitée et une variabilité des revenus."}),e.jsx("p",{className:"font-bold text-amber-900 dark:text-amber-200 pt-2 border-t border-amber-200 dark:border-amber-700",children:"Cette simulation ne constitue pas un conseil en investissement personnalisé et doit être complétée par une étude globale de la situation du client."})]})]})]})]})]})})};export{wt as default};
